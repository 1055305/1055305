---
title: "penguin_assignment.rmd"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(palmerpenguins)
library(ggplot2)
suppressPackageStartupMessages(library(janitor))
suppressPackageStartupMessages(library(dplyr))
library(tidyr)
library(ragg)
library(svglite)
```

```{r}
setwd("C:\\Users\\am\\OneDrive - Nexus365\\Year 3\\Computing\\Penguin projects")

```

```{r}
cleaning <- function(data_raw){
  data_raw %>%
    clean_names() %>%
    remove_empty(c("rows", "cols")) %>%
    select(-starts_with("delta")) %>%
    select(-comments)
}


remove_empty_body_mass<-function(data_clean){data_clean %>%
    filter(!is.na(body_mass_g)) %>%
    select(species, body_mass_g)
}

penguin_cleaned<-cleaning(penguins_raw)
penguin_bodymass<-remove_empty_body_mass(penguin_cleaned)

```
```{r}
filter_species_tocompare<-function(penguin_bodymass, species1, species2){
  filter(penguin_bodymass, species == species1
 | species == species2 , .preserve= FALSE)
}
penguins_filtered<-filter_species_tocompare(penguin_bodymass,"Chinstrap penguin (Pygoscelis antarctica)","Gentoo penguin (Pygoscelis papua)")

```
```{r}
library(car)
leveneTest(data=penguins_filtered, body_mass_g~species, centre=mean)
t.test(data=penguins_filtered, body_mass_g~species, var.equal= FALSE)
```
```{r}
plot_body_mass<-function(penguins_filtered){
  penguins_filtered %>% 
    ggplot( aes(x= body_mass_g, fill=species))+
  geom_histogram(alpha=0.4, position = 'identity')+
  xlab("Body Mass/g")+
  ylab("Number of penguins")+
  labs(fill="Species")+
  theme(legend.title = element_text( size = 10),legend.text = element_text(size = 7))
}
body_mass_hist<-plot_body_mass(penguins_filtered)
body_mass_hist
```

```{r}
library(ragg)
save_bodymass_png <- function(penguins_filtered, 
                                  filename, width, height, res, scaling){
  agg_png(filename, width   =  width, 
                    height  =  height, 
                    units   =  "px", 
                    res     =  res, 
                    scaling =  scaling)
  body_mass_hist <- plot_body_mass(penguins_filtered)
  print(body_mass_hist)
  
  dev.off()
}
save_bodymass_png(penguins_filtered, "figures/bodymass_hist.png",800, 600, 400, 0.3 )
```

